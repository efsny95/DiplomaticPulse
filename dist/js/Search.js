var Suggestion=function(){"use strict";function t(t){this.$parent=$(t),this.$element=e(this.$parent),this.hasSuggestions=!1}var e=function(t){var e='<div id="suggestions"><ul></ul></div>';return t.after(e)};return t}(),Search=function(){"use strict";function t(t,e){this.$input=$(t),this.q=QIX.app,this.field=e||"teaser",this.minChars=3,this.$nohits=$("#search-nohits"),this.init()}var e={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down",32:"space",16:"shift",17:"ctrl"};return t.prototype={_keyup:function(t){return e[t.keyCode]||e[t.which]?!1:(0==t.currentTarget.value.length&&($("#qv-search-clear").hide(),this.$nohits.hide(),this.q.getField(this.field).then(function(t){t.clear().then(function(){$("#main").fadeTo(50,.5).fadeTo(200,1),pubsub.publish("update")})})),t.currentTarget.value.length<this.minChars?!1:($("#qv-search-clear").show(),void this.doSearch(t.target.value)))},bindevents:function(){var t=this;this.$input.on("input",debounce(function(e){t._keyup(e)},250))},lockFields:function(){},doSearch:function(t){var e=this;"="!==t.split("")[0]&&(t=t.split(" ").map(function(t){return"+"+t}).join(" ").trim()),e.listobject.searchListObjectFor("/qListObjectDef",t).then(function(){return e.listobject.getListObjectData("/qListObjectDef",[{qTop:0,qLeft:0,qWidth:1,qHeight:1e3}])}).then(function(t){0===t[0].qMatrix.length?e.listobject.abortListObjectSearch("/qListObjectDef").then(function(){pubsub.publish("nodata")}):e.listobject.getLayout().then(function(t){"O"===t.qListObject.qDataPages[0].qMatrix[0][0].qState?e.listobject.acceptListObjectSearch("/qListObjectDef",!1).then(function(){$("#main").fadeTo(50,.5).fadeTo(200,1),pubsub.publish("update")}):e.listobject.abortListObjectSearch("/qListObjectDef").then(function(){pubsub.publish("nodata",!0)})})})},clear:function(){var t=document.getElementById("qv-search"),e=document.getElementById("qv-search-clear");0!==t.value.length&&(e.style.display="none",this.q.getField(this.field).then(function(e){e.clear().then(function(){t.value="",$("#search-nohits").hide(),$("#main").fadeTo(50,.5).fadeTo(200,1),pubsub.publish("update")})}))},clearFilters:function(){this.q.clearAll().then(function(){document.getElementById("search-nohits-filter").style.display="none",this.doSearch(document.getElementById("qv-search").value)}.bind(this))},nodata:function(t,e){if(e){var i=$("#search-nohits-filter");i.css("width",$("#content").width()).find("span").text($("#qv-search").val()),i.show()}else{var n=$("#search-nohits");n.css("width",$("#content").width()).find("span").text($("#qv-search").val()),n.show()}},init:function(){var t=this;QIX.app.createSessionObject({qInfo:{qId:"",qType:"ListObject"},qSelectionObjectDef:{},qListObjectDef:{qLibraryId:"",qShowAlternatives:!1,count:{qValueExpression:"=Count(teaser)"},qDef:{qFieldDefs:["teaser"]},qSortCriterias:[{qSortByState:1}],qInitialDataFetch:[{qTop:0,qHeight:30,qLeft:0,qWidth:1}]}}).then(function(e){t.listobject=e}),this.bindevents();var e=document.getElementById("qv-search-clear");e.addEventListener("click",function(){this.clear()}.bind(this),!1);var i=document.getElementById("inline-filter-clear");i.addEventListener("click",function(){this.clearFilters()}.bind(this),!1),pubsub.subscribe("nodata",t.nodata)}},t}();